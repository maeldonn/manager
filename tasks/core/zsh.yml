---
- name: Install zsh
  dnf:
    name:
      - zsh
      - util-linux-user
    state: latest

- name: Get zsh path
  shell: which zsh
  register: path

- name: Change shell
  user:
    name: "{{ ansible_env.USER }}"
    shell: "{{ path.stdout }}"

- name: Download antigen file
  shell: curl -L git.io/antigen > antigen.zsh
  args:
    chdir: "{{ ansible_env.HOME }}"
    creates: antigen.zsh

- name: Execute antigen file
  shell: "zsh {{ ansible_env.HOME }}/antigen.zsh"

- name: Move antigen file
  shell: mv antigen.zsh .antigen/antigen.zsh
  args:
    chdir: "{{ ansible_env.HOME }}"
